contains:
  eggs: 2
  cards: 2
  shrooms: 25

areas:
  Start:
    area_connections:
      Dive Room:
        or:
          - comment: Intended route
            whackable:
            - dive

          - comment: Vine entrance
            or:
            - ability: Aerial Attack
            - whackable:
              - throw
                
      Dive Puzzle Platform:
        or:
          - template: super_jumps

          - ability: Dive

          - comment: >
              Extinguish the Keehee and use him as a platform
            or:
            - ability: Bubble
            - carrying: Potion

          - and:
            - ability: Double Jump
            - and:
              - tech: tail_jump
              - or:
                - ability: Grounded Attack
                - ability: Aerial Attack

          - and:
            - ability: Hover
            - or:
              - ability: Double Jump
              - and:
                - tech: tail_jump
                - ability: Grounded Attack
                - or:
                  - tech: hover_jump
                  - ability: High Jump


      Upper Connector:
        or:
          - template: super_jumps

          - comment: Bouncy mushroom + Keehee damage boost
            tech: damage_boost

          - comment: Bouncy mushroom + Z-target bubble shooting
            and:
              - tech: z_target
              - tech: bubble_jump
              - ability: Bubble


          - comment: Hover from the tall bouncy shroom
            ability: Hover

          - ability: High Jump
          - ability: Dive
          - ability: Double Jump
          - and:
            - tech: tail_jump
            - or:
              - ability: Grounded Attack
              - ability: Aerial Attack
      
      Upper:
        or:
          - template: super_jumps

          - comment: Hover from the tall bouncy shroom
            ability: Hover

          - comment: >
              Bouncy mushroom + Keehee damage boost while bubble floating
            and:
            - tech: damage_boost
            - tech: bubble_jump
            - ability: Bubble

      Lava Mushroom Platform:
        null

    entrances:
      Sun Cavern Door:
        to:
          - Sun Cavern
          - Moon Cavern Heart Door

    locations:
      cards:
        Dive:
          and:
            - ability: Swim
            - whackable:
              - dive

      shrooms:
        Dive Holes:
          count: 6
          rule:
            whackable:
              - dive
        Lava Platforms:
          count: 4

        Potionfall:
          count: 1

  Upper Connector:
    area_connections:
      Upper:
        or:
          - ability: High Jump
          - ability: Dive
          - ability: Double Jump
          - and:
            - tech: tail_jump
            - or:
              - ability: Grounded Attack
              - ability: Aerial Attack

      Start:
        null

    locations:
      shrooms:
        Lonely Shroom:
          count: 1

  Upper:
    area_connections:
      Upper Connector:
        null

    entrances:
      Palace Lobby Door:
        to:
          - Palace Lobby
          - Moon Cavern Door

    locations:
      eggs:
        Keehee Climb:
          or:
            - and:
              - ability: Climb
              - ability: Hover
              - or:
                - ability: High Jump
                - ability: Dive

            - ability: Flight

            - tech: bubble_jump
            - tech: super_bounce
      cards:
        Statue: null

      shrooms:
        Palace Lobby Pathway:
          count: 3
        Palace Lobby Statue:
          count: 2
        Palace Lobby Entryway:
          count: 3

  Lava Mushroom Platform:
    area_connections:
      Start:
        or:
          - ability: High Jump
          - ability: Dive
          - ability: Double Jump
          - ability: Grounded Attack
          - ability: Aerial Attack
          - comment: >
              Boost off of the Keehee to the right
            tech: damage_boost

      Nightmare Lobby Door Platform:
        null

    locations:
      shrooms:
        Lava Mushroom Platform:
          count: 2

  Nightmare Lobby Door Platform:
    area_connections:
      Lava Mushroom Platform:
        null

    entrances:
      Nightmare Lobby Door:
        to:
          - Nightmare Lobby
          - Moon Cavern Door
        rule:
          event: (logic) Gallery Lobby Entrance Flame

      Nightmare Lobby Door (Damage Boost):
        to:
          - Nightmare Lobby
          - Moon Cavern Door
        lose:
          - Carryables
          - Jester Boots
        rule:
          comment: Repeated frame-perfect damage momentum cancels
          and:
            - movement: 3
            - tech: momentum_cancel

    locations:
      events:
        (logic) Gallery Lobby Entrance Flame:
          or:
            - carrying: Potion
            - ability: Bubble
              
  Dive Puzzle Platform:
    area_connections:
      Start: null
        
    locations:
      shrooms:
        Dive Puzzle:
          count: 3

  Dive Room:
    area_connections:
      Start:
        or:
          - ability: Climb
          - template: super_jumps
    
    locations:
      eggs:
        Dive Puzzle:
          event: (logic) Solved Dive Puzzle